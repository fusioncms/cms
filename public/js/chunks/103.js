(window.webpackJsonp=window.webpackJsonp||[]).push([[103],{D1a7:function(a,e,t){"use strict";t.r(e);var r=t("LvDl"),n=t.n(r),o=t("nUVr"),s={auth:function(){return{permission:"mailables.update"}},head:{title:function(){return{inner:this.form.name||"Loading..."}}},data:function(){return{id:null,ready:!1,placeholders:{},form:new o.a({name:"",handle:"",markdown:"",status:"1"},!0)}},methods:{isArray:function(a){return n.a.isArray(a)},addPlaceholder:function(a,e){var t=this.$refs.markdown.codemirror.getDoc();t.getCursor();e?t.replaceSelection("{{ $".concat(e,"->").concat(a," }}"),t.getSelection()):t.replaceSelection("{{ $".concat(a," }}"),t.getSelection())},updateMarkdown:function(a){this.form.markdown=a},submit:function(){var a=this;this.form.patch("/api/mailables/"+this.id).then((function(e){toast("Mailable successfully updated","success"),a.$router.push("/mailables")})).catch((function(a){toast(a.response.data.message,"failed")}))},placeholderOptions:function(a){var e=[];return n.a.each(a,(function(a){e.push({label:a,value:a})})),e}},beforeRouteEnter:function(a,e,t){axios.all([axios.get("/api/mailables/".concat(a.params.mailable))]).then(axios.spread((function(a){t((function(e){e.id=a.data.data.id,e.placeholders=a.data.data.placeholders,e.ready=!0,e.form.name=a.data.data.name,e.form.handle=a.data.data.handle,e.form.markdown=a.data.data.markdown,e.$emit("updateHead")}))}))).catch((function(a){t("/mailables"),toast("The requested mailable could not be found","warning")}))}},l=t("KHd+"),i=Object(l.a)(s,(function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("form-container",{scopedSlots:a._u([{key:"sidebar",fn:function(){return[t("div",{staticClass:"card"},[t("div",{staticClass:"card__body"},[t("ui-slug-group",{attrs:{name:"handle",label:"Handle",monospaced:"",autocomplete:"off",required:"",delimiter:"_",watch:a.form.name,"has-error":a.form.errors.has("handle"),"error-message":a.form.errors.get("handle")},model:{value:a.form.handle,callback:function(e){a.$set(a.form,"handle",e)},expression:"form.handle"}}),a._v(" "),t("ui-toggle",{attrs:{name:"status",label:"Status","true-value":1,"false-value":0},model:{value:a.form.status,callback:function(e){a.$set(a.form,"status",e)},expression:"form.status"}})],1)])]},proxy:!0}])},[t("portal",{attrs:{to:"title"}},[t("page-title",{attrs:{icon:"mail-bulk"}},[a._v("Edit Mailable")])],1),a._v(" "),t("portal",{attrs:{to:"actions"}},[t("div",{staticClass:"buttons"},[t("ui-button",{attrs:{to:{name:"mailables"}}},[a._v("Go Back")]),a._v(" "),t("ui-button",{attrs:{type:"submit",variant:"primary",disabled:!a.form.hasChanges},on:{click:function(e){return e.preventDefault(),a.submit(e)}}},[a._v("Save")])],1)]),a._v(" "),t("div",{staticClass:"card"},[t("div",{staticClass:"card__body"},[t("ui-title-group",{attrs:{name:"name",autocomplete:"off",autofocus:"",required:"","has-error":a.form.errors.has("name"),"error-message":a.form.errors.get("name")},model:{value:a.form.name,callback:function(e){a.$set(a.form,"name",e)},expression:"form.name"}}),a._v(" "),t("hr"),a._v(" "),a._l(a.placeholders,(function(e,r){return t("div",{key:r},[a.isArray(e)?a._e():t("ui-button",{on:{click:function(t){return a.addPlaceholder(e)}}},[t("code",[a._v("$"+a._s(e))])]),a._v(" "),t("ui-dropdown",{attrs:{id:r+"-values"},scopedSlots:a._u([{key:"menu",fn:function(){return a._l(e,(function(e,n){return t("ui-dropdown-link",{key:n,on:{click:function(t){return a.addPlaceholder(e,r)}}},[t("code",[a._v(a._s(e))])])}))},proxy:!0}],null,!0)},[t("code",[a._v("$"+a._s(r))])])],1)})),a._v(" "),t("p",{staticClass:"help mt-1 mb-3"},[a._v("Select values to add it to your mail template.")]),a._v(" "),a.ready?t("markdown-fieldtype",{ref:"markdown",attrs:{field:{name:"Content",handle:"markdown"},value:a.form.markdown},on:{input:a.updateMarkdown}}):a._e()],2)])],1)}),[],!1,null,null,null);e.default=i.exports}}]);