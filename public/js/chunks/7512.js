(self.webpackChunkfusioncms=self.webpackChunkfusioncms||[]).push([[7512],{7512:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>l});var o,i=s(6072),n=s(6486),r=s.n(n),a=axios.CancelToken;const c={head:{title:function(){return{inner:"Customize"}}},data:function(){return{theme:{},form:null,url:"/customize",history:[],current:0,window:"desktop",showControls:!0}},computed:{isDesktop:function(){return"desktop"==this.window},isTablet:function(){return"tablet"==this.window},isMobile:function(){return"mobile"==this.window},prettyURL:function(){var t=this.url.replace(/([^:]\/)\/+/g,"$1");return this.parseURL(t)}},watch:{"theme.option":{handler:function(){this.update()},deep:!0}},methods:{navigateBack:function(){if(this.history.length>0){var t=this.current-1,e=this.history[this.history.length-1+t];e&&(this.current=t,this.url=e,this.update())}},navigateForward:function(){if(0!==this.current){var t=this.current+1,e=this.history[this.history.length-1+t];e&&(this.current=t,this.url=e,this.update())}},navigateRefresh:function(){this.update()},navigateHome:function(){this.url="/customize",this.update()},update:r().debounce((function(){var t=this;null!=o&&o(),axios({method:"post",url:this.url,data:this.theme.option,cancelToken:new a((function(t){o=t}))}).then((function(e){t.updateIframe(e.data)})).catch((function(t){if(!axios.isCancel(t))throw t}))}),150),updateIframe:function(t){var e=this.$refs.iframe;e.contentWindow.document.open(),e.contentWindow.document.write(t),e.contentWindow.document.close()},onLoadIframe:function(t){var e=this.$refs.iframe.contentWindow.location.toString();"about:blank"==e?(this.url="/customize",this.history[this.history.length-1]!=this.url&&(this.history.push(this.url),this.current=0),this.update()):r().endsWith(e,"/customize")||(this.url=e+"/customize",this.history[this.history.length-1]!=this.url&&(this.history.push(this.url),this.current=0),this.update()),this.history[this.history.length+this.current]==this.url&&(this.current=this.current+1)},parseURL:function(t){var e=document.createElement("a");return e.href=t,e},submit:function(){this.form.patch("/api/themes/"+this.theme.namespace).then((function(t){toast("Theme options have been updated","success")})).catch((function(t){toast(t.response.data.message,"failed")}))},setWindow:function(t){this.window=t},toggleControls:function(){this.showControls=!this.showControls,this.$nextTick((function(){this.showControls?this.$refs["hide-controls"].focus():this.$refs["show-controls"].focus()}))}},beforeRouteEnter:function(t,e,s){axios.all([axios.get("/api/theme")]).then(axios.spread((function(t){s((function(e){var s=t.data.data.option;r().unset(s,"_json"),e.theme=t.data.data,e.form=new i.Z(s,!0)}))})))}};const l=(0,s(1900).Z)(c,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"preview"},[s("div",{staticClass:"preview__controls",class:{"w-0 border-0":!t.showControls},attrs:{"aria-hidden":!t.showControls}},[s("button",{ref:"show-controls",staticClass:"simple-button show-controls-button",class:{hidden:t.showControls,"inline-block":!t.showControls},on:{click:t.toggleControls}},[s("fa-icon",{staticClass:"fa-fw",attrs:{icon:["fas","caret-square-right"]}}),t._v(" Show Controls")],1),t._v(" "),s("div",{staticClass:"controls",class:{hidden:!t.showControls}},[s("div",{staticClass:"controls__header"},[s("router-link",{staticClass:"flex items-center px-3 py-2 border-r border-gray-300 leading-none",attrs:{exact:"",to:{name:"dashboard"}}},[s("fa-icon",{staticClass:"fa-fw",attrs:{icon:["fas","times"]}})],1),t._v(" "),s("div",{staticClass:"px-3 py-3"},[s("button",{staticClass:"button button--primary button--small",attrs:{type:"submit"},on:{click:function(e){return e.preventDefault(),t.submit(e)}}},[t._v("Save")])])],1),t._v(" "),s("div",{staticClass:"controls__content"},[s("ui-accordion",{attrs:{multiple:!0}},t._l(t.theme.options,(function(e,o){return s("ui-accordion-item",{key:e.handle,attrs:{title:e.name}},[s("div",{staticClass:"p-3"},[e.description?s("p",{staticClass:"text-sm"},[t._v(t._s(e.description))]):t._e(),t._v(" "),t._l(e.fields,(function(e,i){return s(e.fieldtype+"-fieldtype",{key:i,tag:"component",staticClass:"mb-8",attrs:{field:{name:e.name,handle:o,help:e.help,settings:e.settings||{}}},model:{value:t.form[o][i],callback:function(e){t.$set(t.form[o],i,e)},expression:"form[handle][fieldHandle]"}})}))],2)])})),1)],1),t._v(" "),s("div",{staticClass:"controls__footer"},[s("button",{ref:"hide-controls",staticClass:"simple-button hide-controls-button",on:{click:t.toggleControls}},[s("fa-icon",{staticClass:"fa-fw",attrs:{icon:["fas","caret-square-left"]}}),t._v(" Hide Controls")],1),t._v(" "),s("div",{staticClass:"flex border-l border-gray-300"},[s("button",{staticClass:"simple-button relative inline-flex items-center px-3 py-2 border-b-4 border-gray-300 hover:border-gray-500",class:{"hover:border-primary-500 border-primary-500":t.isDesktop},on:{click:function(e){return t.setWindow("desktop")}}},[s("fa-icon",{staticClass:"fa-fw",attrs:{icon:["fas","desktop"]}})],1),t._v(" "),s("button",{staticClass:"simple-button relative inline-flex items-center px-3 py-2 border-b-4 border-gray-300 hover:border-gray-500",class:{"hover:border-primary-500 border-primary-500":t.isTablet},on:{click:function(e){return t.setWindow("tablet")}}},[s("fa-icon",{staticClass:"fa-fw",attrs:{icon:["fas","tablet-alt"]}})],1),t._v(" "),s("button",{staticClass:"simple-button relative inline-flex items-center px-3 py-2 border-b-4 border-gray-300 hover:border-gray-500",class:{"hover:border-primary-500 border-primary-500":t.isMobile},on:{click:function(e){return t.setWindow("mobile")}}},[s("fa-icon",{staticClass:"fa-fw",attrs:{icon:["fas","mobile-alt"]}})],1)])])])]),t._v(" "),s("div",{staticClass:"preview__window flex-col"},[s("div",{staticClass:"w-full px-2 bg-white border-b border-gray-300 flex items-center py-1"},[s("button",{staticClass:"mr-1 w-8 h-8 focus:outline-none hover:bg-gray-200 rounded-full",on:{click:function(e){return e.preventDefault(),t.navigateBack(e)}}},[s("fa-icon",{staticClass:"fa-fw text-gray-700",attrs:{icon:["fas","arrow-left"]}})],1),t._v(" "),s("button",{staticClass:"mr-1 w-8 h-8 focus:outline-none hover:bg-gray-200 rounded-full",on:{click:function(e){return e.preventDefault(),t.navigateForward(e)}}},[s("fa-icon",{staticClass:"fa-fw text-gray-700",attrs:{icon:["fas","arrow-right"]}})],1),t._v(" "),s("button",{staticClass:"mr-1 w-8 h-8 focus:outline-none hover:bg-gray-200 rounded-full",on:{click:function(e){return e.preventDefault(),t.navigateRefresh(e)}}},[s("fa-icon",{staticClass:"fa-fw text-gray-700",attrs:{icon:["fas","redo"]}})],1),t._v(" "),s("button",{staticClass:"mr-1 w-8 h-8 focus:outline-none hover:bg-gray-200 rounded-full",on:{click:function(e){return e.preventDefault(),t.navigateHome(e)}}},[s("fa-icon",{staticClass:"fa-fw text-gray-700",attrs:{icon:["fas","home"]}})],1),t._v(" "),s("div",{staticClass:"px-6 py-2 bg-gray-200 rounded-full text-gray-700 flex flex-1 mr-2 items-center leading-none"},[s("span",[t._v(t._s(t.prettyURL))])])]),t._v(" "),s("div",{staticClass:"window",class:"window--"+t.window},[s("iframe",{ref:"iframe",on:{load:t.onLoadIframe}})])]),t._v(" "),s("confirm-modal")],1)}),[],!1,null,null,null).exports}}]);