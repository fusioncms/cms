(window.webpackJsonp=window.webpackJsonp||[]).push([[85],{"1m+V":function(t,o,e){"use strict";e.r(o);var s,n=e("nUVr"),i=e("LvDl"),a=e.n(i),r=axios.CancelToken,l={head:{title:function(){return{inner:"Customize"}}},data:function(){return{theme:{},form:null,url:"/customize",window:"desktop",showControls:!0}},computed:{isDesktop:function(){return"desktop"==this.window},isTablet:function(){return"tablet"==this.window},isMobile:function(){return"mobile"==this.window}},watch:{"theme.option":{handler:function(){this.form.onFirstChange(),this.update()},deep:!0}},methods:{update:a.a.debounce((function(){var t=this;null!=s&&s(),axios({method:"post",url:this.url,data:this.theme.option,cancelToken:new r((function(t){s=t}))}).then((function(o){t.updateIframe(o.data)})).catch((function(t){if(!axios.isCancel(t))throw t}))}),150),updateIframe:function(t){var o=this.$refs.iframe;o.contentWindow.document.open(),o.contentWindow.document.write(t),o.contentWindow.document.close()},onLoadIframe:function(t){var o=this.$refs.iframe.contentWindow.location.toString();"about:blank"==o||a.a.endsWith(o,"/customize")||(this.url=o+"/customize",this.update())},submit:function(){this.form.patch("/api/themes/"+this.theme.namespace).then((function(t){toast("Theme options have been updated","success")})).catch((function(t){toast(t.response.data.message,"failed")}))},setWindow:function(t){this.window=t},toggleControls:function(){this.showControls=!this.showControls,this.$nextTick((function(){this.showControls?this.$refs["hide-controls"].focus():this.$refs["show-controls"].focus()}))}},beforeRouteEnter:function(t,o,e){axios.all([axios.get("/api/theme")]).then(axios.spread((function(t){e((function(o){var e=t.data.data.option;a.a.unset(e,"_json"),o.theme=t.data.data,o.form=new n.a(e,!0)}))})))}},c=e("KHd+"),d=Object(c.a)(l,(function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",{staticClass:"preview"},[e("div",{staticClass:"preview__controls",class:{"w-0 border-0":!t.showControls},attrs:{"aria-hidden":!t.showControls}},[e("button",{ref:"show-controls",staticClass:"simple-button show-controls-button",class:{hidden:t.showControls,"inline-block":!t.showControls},on:{click:t.toggleControls}},[e("fa-icon",{staticClass:"fa-fw",attrs:{icon:["fas","caret-square-right"]}}),t._v(" Show Controls")],1),t._v(" "),e("div",{staticClass:"controls",class:{hidden:!t.showControls}},[e("div",{staticClass:"controls__header"},[e("router-link",{staticClass:"flex items-center px-3 py-2 border-r border-gray-300 leading-none",attrs:{exact:"",to:{name:"dashboard"}}},[e("fa-icon",{staticClass:"fa-fw",attrs:{icon:["fas","times"]}})],1),t._v(" "),e("div",{staticClass:"px-3 py-3"},[e("button",{staticClass:"button button--primary button--small",attrs:{type:"submit"},on:{click:function(o){return o.preventDefault(),t.submit(o)}}},[t._v("Save")])])],1),t._v(" "),e("div",{staticClass:"controls__content"},[e("p-accordion",{attrs:{multiple:!0}},t._l(t.theme.options,(function(o,s){return e("p-accordion-item",{key:o.handle,attrs:{title:o.name}},[e("div",{staticClass:"p-3"},[o.description?e("p",{staticClass:"text-sm"},[t._v(t._s(o.description))]):t._e(),t._v(" "),t._l(o.fields,(function(o,n){return e(o.fieldtype+"-fieldtype",{key:n,tag:"component",staticClass:"mb-8",attrs:{field:{name:o.name,handle:s,help:o.help,settings:o.settings||{}}},model:{value:t.form[s][n],callback:function(o){t.$set(t.form[s],n,o)},expression:"form[handle][fieldHandle]"}})}))],2)])})),1)],1),t._v(" "),e("div",{staticClass:"controls__footer"},[e("button",{ref:"hide-controls",staticClass:"simple-button hide-controls-button",on:{click:t.toggleControls}},[e("fa-icon",{staticClass:"fa-fw",attrs:{icon:["fas","caret-square-left"]}}),t._v(" Hide Controls")],1),t._v(" "),e("div",{staticClass:"flex border-l border-gray-300"},[e("button",{staticClass:"simple-button relative inline-flex items-center px-3 py-2 border-b-4 border-gray-300 hover:border-gray-500",class:{"hover:border-primary-500 border-primary-500":t.isDesktop},on:{click:function(o){return t.setWindow("desktop")}}},[e("fa-icon",{staticClass:"fa-fw",attrs:{icon:["fas","desktop"]}})],1),t._v(" "),e("button",{staticClass:"simple-button relative inline-flex items-center px-3 py-2 border-b-4 border-gray-300 hover:border-gray-500",class:{"hover:border-primary-500 border-primary-500":t.isTablet},on:{click:function(o){return t.setWindow("tablet")}}},[e("fa-icon",{staticClass:"fa-fw",attrs:{icon:["fas","tablet-alt"]}})],1),t._v(" "),e("button",{staticClass:"simple-button relative inline-flex items-center px-3 py-2 border-b-4 border-gray-300 hover:border-gray-500",class:{"hover:border-primary-500 border-primary-500":t.isMobile},on:{click:function(o){return t.setWindow("mobile")}}},[e("fa-icon",{staticClass:"fa-fw",attrs:{icon:["fas","mobile-alt"]}})],1)])])])]),t._v(" "),e("div",{staticClass:"preview__window"},[e("div",{staticClass:"window",class:"window--"+t.window},[e("iframe",{ref:"iframe",on:{load:t.onLoadIframe}})])]),t._v(" "),e("confirm-modal")],1)}),[],!1,null,null,null);o.default=d.exports}}]);