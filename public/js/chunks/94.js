(window.webpackJsonp=window.webpackJsonp||[]).push([[94],{C6Uj:function(t,a,e){"use strict";e.r(a);var o={head:{title:function(){return{inner:"Backups"}}},data:function(){return{endpoint:"/datatable/backups",saveBackup:!0,isBusy:!1}},watch:{isBusy:function(t){this.$store.commit("form/setPreventNavigation",t),t||bus().$emit("refresh-datatable-backups")}},methods:{upload:function(t){var a=this;if(void 0!==t){var e=new FormData;e.append("_method","POST"),e.append("file-upload",t),axios.post("/api/backups/upload",e).then((function(){toast("Backup successfully uploaded!","success"),a.$refs.upload.remove(),bus().$emit("refresh-datatable-backups")}))}},download:function(t){window.open("/backups/".concat(t),"_blank")},restore:function(t){var a=this;this.isBusy=!0,axios.post("/api/backups/restore/".concat(t),{saveBackup:this.saveBackup}).then((function(t){a.isBusy=!1,toast("Backup successfully restored!","success")})).catch((function(t){a.isBusy=!1,toast(t.response.data.message,"failed")}))},backup:function(){var t=this;this.isBusy=!0,axios.post("/api/backups").then((function(a){t.isBusy=!1,toast("Backup successfully created!","success")})).catch((function(a){t.isBusy=!1,toast(a.response.data.message,"failed")}))},destroy:function(t){axios.delete("/api/backups/".concat(t)).then((function(t){toast("Backp successfully deleted!","success"),bus().$emit("refresh-datatable-backups")}))}}},s=e("KHd+"),r=Object(s.a)(o,(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"backup-page"},[e("portal",{attrs:{to:"title"}},[e("page-title",{attrs:{icon:"save"}},[t._v("Backups")])],1),t._v(" "),e("portal",{attrs:{to:"actions"}},[e("ui-button",{directives:[{name:"modal",rawName:"v-modal:settings",arg:"settings"}],staticClass:"mr-1",attrs:{disabled:t.isBusy}},[t._v("Settings")]),t._v(" "),e("ui-button",{directives:[{name:"modal",rawName:"v-modal:upload",arg:"upload"}],staticClass:"mr-1",attrs:{disabled:t.isBusy}},[t._v("Upload")]),t._v(" "),t.isBusy?e("ui-button",{attrs:{variant:"primary",disabled:""}},[e("fa-icon",{staticClass:"fa-spin",attrs:{icon:"sync"}}),t._v(" "),e("span",{staticClass:"sr-only"},[t._v("Working")])],1):e("ui-button",{directives:[{name:"modal",rawName:"v-modal:confirm-form",arg:"confirm-form"}],attrs:{variant:"primary"},on:{click:function(t){t.preventDefault()}}},[t._v("Backup Now")])],1),t._v(" "),e("ui-card",[e("ui-card-body",[e("ui-table",{key:"backups",staticClass:"backup-table",attrs:{id:"backups",endpoint:t.endpoint,"sort-by":"name","sort-in":"desc","per-page":50},scopedSlots:t._u([{key:"actions",fn:function(a){return t.isBusy?void 0:[e("ui-table-actions",{key:"backup_"+a.record.id+"_actions",attrs:{id:"backup_"+a.record.id+"_actions"}},[e("ui-dropdown-link",{directives:[{name:"modal",rawName:"v-modal:restore-form",value:a.record,expression:"table.record",arg:"restore-form"}],on:{click:function(t){t.preventDefault()}}},[t._v("\n\t\t\t\t\t\t\t\tRestore\n\t\t\t\t\t\t\t")]),t._v(" "),e("ui-dropdown-link",{on:{click:function(e){return e.preventDefault(),t.download(a.record.name)}}},[t._v("\n\t\t\t\t\t\t\t\tDownload\n\t\t\t\t\t\t\t")]),t._v(" "),a.record.isLatest?t._e():e("ui-dropdown-link",{directives:[{name:"modal",rawName:"v-modal:delete-form",value:a.record,expression:"table.record",arg:"delete-form"}],on:{click:function(t){t.preventDefault()}}},[t._v("\n\t\t\t\t\t\t\t\tDelete\n\t\t\t\t\t\t\t")])],1)]}}],null,!0)})],1)],1),t._v(" "),e("portal",{attrs:{to:"modals"}},[e("settings-modal",{attrs:{handle:"backups"}}),t._v(" "),e("ui-modal",{key:"restore_form",attrs:{name:"restore-form",title:"Restore Backup"},scopedSlots:t._u([{key:"footer",fn:function(a){return[e("ui-button",{directives:[{name:"modal",rawName:"v-modal:restore-form",arg:"restore-form"}],staticClass:"ml-3",attrs:{variant:"primary"},on:{click:function(e){return t.restore(a.data.name)}}},[t._v("Restore")]),t._v(" "),e("ui-button",{directives:[{name:"modal",rawName:"v-modal:restore-form",arg:"restore-form"}]},[t._v("Cancel")])]}}])},[e("p",[t._v("Restoring a backup will "),e("b",[t._v("replace all files and the database with the contents of the backup.")]),t._v(" Unless you specify to create a new backup during this process, there will be no way to undo your changes if you change your mind.")]),t._v(" "),e("ui-checkbox",{attrs:{name:"saveBackup"},model:{value:t.saveBackup,callback:function(a){t.saveBackup=a},expression:"saveBackup"}},[t._v("\n        \t\t\tCreate a backup before restoring\n        \t\t")])],1),t._v(" "),e("ui-modal",{key:"confirm_form",attrs:{name:"confirm-form",title:"Backup Now"}},[e("p",[t._v("This will perform a full backup of your website. Backups can take up to one minute per GB of data.")]),t._v(" "),e("template",{slot:"footer"},[e("ui-button",{directives:[{name:"modal",rawName:"v-modal:confirm-form",arg:"confirm-form"}],staticClass:"ml-3",attrs:{variant:"primary"},on:{click:function(a){return t.backup()}}},[t._v("Backup")]),t._v(" "),e("ui-button",{directives:[{name:"modal",rawName:"v-modal:confirm-form",arg:"confirm-form"}]},[t._v("Cancel")])],1)],2),t._v(" "),e("ui-modal",{key:"delete_form",attrs:{name:"delete-form",title:"Delete Backup"},scopedSlots:t._u([{key:"footer",fn:function(a){return[e("ui-button",{directives:[{name:"modal",rawName:"v-modal:delete-form",arg:"delete-form"}],staticClass:"ml-3",attrs:{variant:"danger"},on:{click:function(e){return t.destroy(a.data.name)}}},[t._v("Delete")]),t._v(" "),e("ui-button",{directives:[{name:"modal",rawName:"v-modal:delete-form",arg:"delete-form"}]},[t._v("Cancel")])]}}])},[e("p",[t._v("Are you sure you want to permenantly delete this backup?")])]),t._v(" "),e("ui-modal",{key:"upload-backup",attrs:{name:"upload",title:"Upload Backup"}},[e("ui-upload",{ref:"upload",attrs:{name:"file-upload",label:"Upload",accept:"zip",multiple:!1},on:{input:t.upload}})],1)],1)],1)}),[],!1,null,null,null);a.default=r.exports}}]);