(window.webpackJsonp=window.webpackJsonp||[]).push([[94],{C6Uj:function(t,e,a){"use strict";a.r(e);var o={head:{title:function(){return{inner:"Backups"}}},data:function(){return{endpoint:"/datatable/backups",saveBackup:!0}},methods:{upload:function(t){var e=this;if(void 0!==t){var a=new FormData;a.append("_method","POST"),a.append("file-upload",t),axios.post("/api/backups/upload",a).then((function(){toast("Backup successfully uploaded!","success"),e.$refs.upload.remove(),bus().$emit("refresh-datatable-backups")}))}},download:function(t){window.open("/backups/".concat(t),"_blank")},restore:function(t){axios.post("/api/backups/restore/".concat(t),{saveBackup:this.saveBackup}).then((function(t){toast("Backup successfully restored!","success"),bus().$emit("refresh-datatable-backups")}))},backup:function(){axios.post("/api/backups").then((function(t){toast("Backup successfully created!","success"),bus().$emit("refresh-datatable-backups")}))},destroy:function(t){axios.delete("/api/backups/".concat(t)).then((function(t){toast("Backp successfully deleted!","success"),bus().$emit("refresh-datatable-backups")}))}}},r=a("KHd+"),n=Object(r.a)(o,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"backup-page"},[a("portal",{attrs:{to:"title"}},[a("page-title",{attrs:{icon:"save"}},[t._v("Backups")])],1),t._v(" "),a("portal",{attrs:{to:"actions"}},[a("ui-button",{directives:[{name:"modal",rawName:"v-modal:settings",arg:"settings"}],staticClass:"mr-1"},[t._v("Settings")]),t._v(" "),a("ui-button",{directives:[{name:"modal",rawName:"v-modal:upload",arg:"upload"}],staticClass:"mr-3"},[t._v("Upload")]),t._v(" "),a("ui-button",{directives:[{name:"modal",rawName:"v-modal:confirm-form",arg:"confirm-form"}],attrs:{variant:"primary"},on:{click:function(t){t.preventDefault()}}},[t._v("Backup Now")])],1),t._v(" "),a("ui-card",[a("ui-card-body",[a("ui-table",{key:"backups",staticClass:"backup-table",attrs:{id:"backups",endpoint:t.endpoint,"sort-by":"name","per-page":50},scopedSlots:t._u([{key:"actions",fn:function(e){return[a("ui-table-actions",{key:"backup_"+e.record.id+"_actions",attrs:{id:"backup_"+e.record.id+"_actions"}},[a("ui-dropdown-link",{directives:[{name:"modal",rawName:"v-modal:restore-form",value:e.record,expression:"table.record",arg:"restore-form"}],on:{click:function(t){t.preventDefault()}}},[t._v("\n\t\t\t\t\t\t\t\tRestore\n\t\t\t\t\t\t\t")]),t._v(" "),a("ui-dropdown-link",{on:{click:function(a){return a.preventDefault(),t.download(e.record.name)}}},[t._v("\n\t\t\t\t\t\t\t\tDownload\n\t\t\t\t\t\t\t")]),t._v(" "),e.record.isLatest?t._e():a("ui-dropdown-link",{directives:[{name:"modal",rawName:"v-modal:delete-form",value:e.record,expression:"table.record",arg:"delete-form"}],on:{click:function(t){t.preventDefault()}}},[t._v("\n\t\t\t\t\t\t\t\tDelete\n\t\t\t\t\t\t\t")])],1)]}}])})],1)],1),t._v(" "),a("portal",{attrs:{to:"modals"}},[a("settings-modal",{attrs:{handle:"backups"}}),t._v(" "),a("ui-modal",{key:"restore_form",attrs:{name:"restore-form",title:"Restore Backup"},scopedSlots:t._u([{key:"footer",fn:function(e){return[a("ui-button",{directives:[{name:"modal",rawName:"v-modal:restore-form",arg:"restore-form"}],staticClass:"ml-3",attrs:{variant:"primary"},on:{click:function(a){return t.restore(e.data.name)}}},[t._v("Restore")]),t._v(" "),a("ui-button",{directives:[{name:"modal",rawName:"v-modal:restore-form",arg:"restore-form"}]},[t._v("Cancel")])]}}])},[a("p",[t._v("Restoring a backup will "),a("b",[t._v("replace all files and the database with the contents of the backup.")]),t._v(" Unless you specify to create a new backup during this process, there will be no way to undo your changes if you change your mind.")]),t._v(" "),a("ui-checkbox",{attrs:{name:"saveBackup"},model:{value:t.saveBackup,callback:function(e){t.saveBackup=e},expression:"saveBackup"}},[t._v("\n        \t\t\tCreate a backup before restoring\n        \t\t")])],1),t._v(" "),a("ui-modal",{key:"confirm_form",attrs:{name:"confirm-form",title:"Backup Now"}},[a("p",[t._v("This will perform a full backup of your website. Backups can take up to one minute per GB of data.")]),t._v(" "),a("template",{slot:"footer"},[a("ui-button",{directives:[{name:"modal",rawName:"v-modal:confirm-form",arg:"confirm-form"}],staticClass:"ml-3",attrs:{variant:"primary"},on:{click:function(e){return t.backup()}}},[t._v("Backup")]),t._v(" "),a("ui-button",{directives:[{name:"modal",rawName:"v-modal:confirm-form",arg:"confirm-form"}]},[t._v("Cancel")])],1)],2),t._v(" "),a("ui-modal",{key:"delete_form",attrs:{name:"delete-form",title:"Delete Backup"},scopedSlots:t._u([{key:"footer",fn:function(e){return[a("ui-button",{directives:[{name:"modal",rawName:"v-modal:delete-form",arg:"delete-form"}],staticClass:"ml-3",attrs:{variant:"danger"},on:{click:function(a){return t.destroy(e.data.name)}}},[t._v("Delete")]),t._v(" "),a("ui-button",{directives:[{name:"modal",rawName:"v-modal:delete-form",arg:"delete-form"}]},[t._v("Cancel")])]}}])},[a("p",[t._v("Are you sure you want to permenantly delete this backup?")])]),t._v(" "),a("ui-modal",{key:"upload-backup",attrs:{name:"upload",title:"Upload Backup"}},[a("ui-upload",{ref:"upload",attrs:{name:"file-upload",label:"Upload",accept:"zip",multiple:!1},on:{input:t.upload}})],1)],1)],1)}),[],!1,null,null,null);e.default=n.exports}}]);