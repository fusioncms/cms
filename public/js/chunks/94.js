(window.webpackJsonp=window.webpackJsonp||[]).push([[94],{C6Uj:function(e,t,a){"use strict";a.r(t);var o={head:{title:function(){return{inner:"Backups"}}},mixins:[a("Huo5").default],data:function(){return{endpoint:"/datatable/backups",saveBackup:!0,inProgress:!1}},watch:{inProgress:function(e){this.$store.commit("form/setPreventNavigation",e),e||bus().$emit("refresh-datatable-backups")}},methods:{upload:function(e){var t=this;if(void 0!==e){var a=new FormData;a.append("_method","POST"),a.append("file-upload",e),axios.post("/api/backups/upload",a).then((function(){toast("Backup successfully uploaded!","success"),t.$refs.upload.remove(),bus().$emit("refresh-datatable-backups")}))}},download:function(e){window.open("/backups/".concat(e),"_blank")},restore:function(e){var t=this;this.inProgress=!0,axios.post("/api/backups/restore/".concat(e.disk,"/").concat(e.name),{saveBackup:this.saveBackup}).then((function(e){t.inProgress=!1,toast("Backup successfully restored!","success")})).catch((function(e){t.inProgress=!1,toast(e.response.data.message,"failed")}))},backup:function(){var e=this;this.inProgress=!0,axios.post("/api/backups").then((function(t){e.inProgress=!1,toast("Backup successfully created!","success")})).catch((function(t){e.inProgress=!1,toast(t.response.data.message,"failed")}))},destroy:function(e){axios.delete("/api/backups/".concat(e.disk,"/").concat(e.name)).then((function(e){toast("Backp successfully deleted!","success"),bus().$emit("refresh-datatable-backups")}))}}},r=a("KHd+"),s=Object(r.a)(o,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"backup-page"},[a("portal",{attrs:{to:"title"}},[a("page-title",{attrs:{icon:"save"}},[e._v("Backups")])],1),e._v(" "),a("portal",{attrs:{to:"actions"}},[a("ui-button",{directives:[{name:"modal",rawName:"v-modal:settings",arg:"settings"}],staticClass:"mr-1"},[e._v("Settings")]),e._v(" "),a("ui-button",{directives:[{name:"modal",rawName:"v-modal:upload-backup",arg:"upload-backup"}],staticClass:"mr-1"},[e._v("Upload")]),e._v(" "),a("ui-button",{directives:[{name:"modal",rawName:"v-modal:confirm-form",arg:"confirm-form"}],attrs:{variant:"primary"},on:{click:function(e){e.preventDefault()}}},[e._v("Backup Now")])],1),e._v(" "),a("ui-card",[a("ui-card-body",[a("ui-table",{key:"backups",staticClass:"backup-table",attrs:{id:"backups",endpoint:e.endpoint,"sort-by":"name","sort-in":"desc","per-page":50},scopedSlots:e._u([{key:"size",fn:function(t){return[a("code",[e._v(e._s(e.filesize(t.record.size)))])]}},{key:"created_at",fn:function(t){return[e._v("\n                        "+e._s(e.$moment(t.record.created_at).fromNow())+"\n                    ")]}},{key:"actions",fn:function(t){return[a("ui-table-actions",{key:"backup_"+t.record.id+"_actions",attrs:{id:"backup_"+t.record.id+"_actions"}},[a("ui-dropdown-link",{directives:[{name:"modal",rawName:"v-modal:restore-form",value:t.record,expression:"table.record",arg:"restore-form"}],on:{click:function(e){e.preventDefault()}}},[e._v("\n\t\t\t\t\t\t\t\tRestore\n\t\t\t\t\t\t\t")]),e._v(" "),a("ui-dropdown-link",{on:{click:function(a){return a.preventDefault(),e.download(t.record.name)}}},[e._v("\n\t\t\t\t\t\t\t\tDownload\n\t\t\t\t\t\t\t")]),e._v(" "),t.record.isLatest?e._e():a("ui-dropdown-link",{directives:[{name:"modal",rawName:"v-modal:delete-form",value:t.record,expression:"table.record",arg:"delete-form"}],on:{click:function(e){e.preventDefault()}}},[e._v("\n\t\t\t\t\t\t\t\tDelete\n\t\t\t\t\t\t\t")])],1)]}}])})],1)],1),e._v(" "),a("portal",{attrs:{to:"modals"}},[a("settings-modal",{attrs:{handle:"backups"}}),e._v(" "),a("ui-modal",{key:"restore_form",attrs:{name:"restore-form",title:"Restore Backup"},scopedSlots:e._u([{key:"footer",fn:function(t){return[a("ui-button",{directives:[{name:"modal",rawName:"v-modal:restore-form",arg:"restore-form"}],staticClass:"ml-3",attrs:{variant:"primary"},on:{click:function(a){return e.restore(t.data)}}},[e._v("Restore")]),e._v(" "),a("ui-button",{directives:[{name:"modal",rawName:"v-modal:restore-form",arg:"restore-form"}]},[e._v("Cancel")])]}}])},[a("p",[e._v("Restoring a backup will "),a("b",[e._v("replace all files and the database with the contents of the backup.")]),e._v(" Unless you specify to create a new backup during this process, there will be no way to undo your changes if you change your mind.")]),e._v(" "),a("ui-checkbox",{attrs:{id:"saveBackup",name:"saveBackup"},model:{value:e.saveBackup,callback:function(t){e.saveBackup=t},expression:"saveBackup"}},[e._v("\n        \t\t\tCreate a backup before restoring\n        \t\t")])],1),e._v(" "),a("ui-modal",{key:"confirm_form",attrs:{name:"confirm-form",title:"Backup Now"}},[a("p",[e._v("This will perform a full backup of your website. Backups can take up to one minute per GB of data.")]),e._v(" "),a("template",{slot:"footer"},[a("ui-button",{directives:[{name:"modal",rawName:"v-modal:confirm-form",arg:"confirm-form"}],staticClass:"ml-3",attrs:{variant:"primary"},on:{click:function(t){return e.backup()}}},[e._v("Backup")]),e._v(" "),a("ui-button",{directives:[{name:"modal",rawName:"v-modal:confirm-form",arg:"confirm-form"}]},[e._v("Cancel")])],1)],2),e._v(" "),a("ui-modal",{key:"delete_form",attrs:{name:"delete-form",title:"Delete Backup"},scopedSlots:e._u([{key:"footer",fn:function(t){return[a("ui-button",{directives:[{name:"modal",rawName:"v-modal:delete-form",arg:"delete-form"}],staticClass:"ml-3",attrs:{variant:"danger"},on:{click:function(a){return e.destroy(t.data)}}},[e._v("Delete")]),e._v(" "),a("ui-button",{directives:[{name:"modal",rawName:"v-modal:delete-form",arg:"delete-form"}]},[e._v("Cancel")])]}}])},[a("p",[e._v("Are you sure you want to permenantly delete this backup?")])]),e._v(" "),a("ui-modal",{key:"upload_backup",attrs:{name:"upload-backup",title:"Upload Backup"}},[a("ui-upload",{ref:"upload",attrs:{name:"file-upload",label:"Upload",accept:"zip",multiple:!1},on:{input:e.upload}})],1),e._v(" "),a("ui-modal",{key:"in_progress",attrs:{size:"small",name:"in-progress",noFooter:"",noHeader:"",noEscClose:""},model:{value:e.inProgress,callback:function(t){e.inProgress=t},expression:"inProgress"}},[a("div",{staticClass:"mx-auto flex flex-col items-center justify-center"},[a("fa-icon",{staticClass:"fa-spin text-primary-500 text-3xl m-3",attrs:{icon:"sync"}}),e._v(" "),a("h3",[e._v("Please wait while we process your request.")])],1)])],1)],1)}),[],!1,null,null,null);t.default=s.exports}}]);